-- 0312 시험 대비

SELECT * FROM emp;
SELECT * FROM dept;
SELECT * FROM salgrade;


-- 4
SELECT 
	EMPNO
	, ENAME
	, SAL
	, COMM
FROM emp
WHERE (SAL<=500 OR SAL>=1500)
AND COMM IS NOT NULL;


-- 5
SELECT 
	EMPNO
	, ENAME
	, HIREDATE
FROM emp
WHERE ENAME LIKE '이%'
ORDER BY EMPNO ASC;

-- 6
SELECT 
	EMPNO
	, ENAME
	, DEPTNO
	, CASE WHEN DEPTNO=10 THEN '인사부' 
			 WHEN DEPTNO=20 THEN '영업부'
		ELSE '생산부'	
		END 부서명 
FROM emp;

-- 7 
SELECT 
	EMPNO
	, ENAME
	, HIREDATE
	, COMM
	, DATE_FORMAT(HIREDATE, '%Y') 입사년도
FROM emp
WHERE DATE_FORMAT(HIREDATE, '%Y')= 2007 
ORDER BY HIREDATE ASC;


SELECT * FROM emp;

-- 8
SELECT 
	JOB, SUM(SAL), AVG(SAL), AVG(COMM) 
FROM emp
GROUP BY JOB
ORDER BY JOB ASC;



-- 9
SELECT 
	EMPNO
	, ENAME
	, HIREDATE
	, SAL
	, DEPTNO
	, (SELECT LOC FROM dept WHERE emp.DEPTNO=dept.DEPTNO) AS LOCATION
FROM emp
WHERE DEPTNO=(SELECT DEPTNO FROM dept WHERE LOC='서울');

-- 10
SELECT 
	EMPNO
	, ENAME
	, HIREDATE
	, SAL
	, emp.DEPTNO
	, LOC
FROM emp
INNER JOIN dept
ON emp.DEPTNO = dept.DEPTNO
WHERE LOC='서울';